<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=IBM+Plex+Sans:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="text.css" />
</head>
<body>
  <header class="bar">
    <a class="back" href="index.html">← Back</a>
  </header>

  <main class="page">
    <P class="puzzle">
        in the last stage of a desperate adventure, on a Western island. I remember the 
final words, repeated at the end of each version like a secret command: "Thus the 
heroes fought, with tranquil heart and bloody sword. They were resigned to killing 
and to dying." 
    </P>
    <P class="puzzle">
        At that moment I felt within me and around me something invisible and intangible 
pullulating. It was not the pullulation of two divergent, parallel, and finally converging 
armies, but an agitation more inaccessible, more intimate, prefigured by them in 
some way. Stephen Albert continued: 
    </P>
    <P class="puzzle">
        "I do not think that your illustrious ancestor toyed idly with variations. I do not find 
it believable that he would waste thirteen years laboring over a never ending 
experiment in rhetoric. In your country the novel is an inferior genre; in Ts'ui Pen's 
period, it was a despised one. Ts'ui Pen was a fine novelist but he was also a man of 
letters who, doubtless, considered himself more than a mere novelist. The testimony 
of his contemporaries attests to this, and certainly the known facts of his life confirm 
his leanings toward the metaphysical and the mystical. Philosophical conjectures take 
up the greater part of his novel. I know that of all problems, none disquieted him 
more, and none concerned him more than the profound one of time. Now then, this 
is the only problem that does not figure in the pages of The Garden. He does not 
even use the word which means time. How can these voluntary omissions be 
explained?" 
    </P>
    <P class="puzzle">
        I proposed various solutions, all of them inadequate. We discussed them. Finally 
Stephen Albert said: "In a guessing game to which the answer is chess, which word is 
the only one prohibited?" I thought for a moment and then replied: 
    </P>
    <P class="puzzle">
        "The word is chess." 
    </P>
    <P class="puzzle">
        "Precisely," said Albert. "The Garden of Forking Paths is an enormous guessing game, 
or parable, in which the subject is time. The rules of the game forbid the use of the 
word itself. To eliminate a word completely, to refer to it by means of inept phrases 
and obvious paraphrases, is perhaps the best way of drawing attention to it. This, 
then, is the tortuous method of approach preferred by the oblique Ts'ui Pen in every 
meandering of his interminable novel. I have gone over hundreds of manuscripts, I 
have corrected errors introduced by careless copyists, I have worked out the plan 
from this chaos, I have restored, or believe I have restored, the original. I have 
translated the whole work. I can state categorically that not once has the word time 
been used in the whole book. 
    </P>
    <P class="puzzle">
        "The explanation is obvious. The Garden of Forking Paths is a picture, incomplete 
yet not false, of the universe such as Ts'ui Pen conceived it to be. Differing from 
Newton and Schopenhauer, your ancestor did not think of time as absolute and 
uniform. He believed in an infinite series of times, in a dizzily growing, ever spreading 
network of diverging, converging and parallel times. This web of time - the strands of 
which approach one another, bifurcate, intersect or ignore each other through the 
centuries - embraces every possibility. We do not exist in most of them. In some 
you exist and not I, while in others I do, and you do not, and in yet others both of us 
exist. In this one, in which chance has favored me, you have come to my gate. In 
another, you, crossing the garden, have found me dead. In yet another, I say these 
very same words, but am an error, a phantom." 
    </P>
     </main>
</body>
</html>
<!-- JS 放在 body 最底部 -->
  <script>
    /**
     * 把<p class="puzzle">里的纯文本切成“碎片span”
     * 你可以调 chunkSize 来控制每片的长度（越小越碎，越像拼图）
     */
    const chunkSize = 26; // 每片大概多少字符（建议 18-32）

    function splitIntoChunks(text, size) {
      const clean = text.replace(/\s+/g, ' ').trim();
      const chunks = [];
      let i = 0;

      while (i < clean.length) {
        // 尽量在空格处断开，不要硬切断单词
        let end = Math.min(i + size, clean.length);
        if (end < clean.length) {
          const lastSpace = clean.lastIndexOf(' ', end);
          if (lastSpace > i + 8) end = lastSpace; // 8 是防止切得太短
        }
        chunks.push(clean.slice(i, end));
        i = end + 1;
      }
      return chunks;
    }

    function randomFromSides() {
      // 0上 1右 2下 3左
      const side = Math.floor(Math.random() * 4);
      const dist = 140 + Math.random() * 220;
      let dx = 0, dy = 0;

      if (side === 0) { dy = -dist; dx = (Math.random() - 0.5) * dist; }
      if (side === 1) { dx =  dist; dy = (Math.random() - 0.5) * dist; }
      if (side === 2) { dy =  dist; dx = (Math.random() - 0.5) * dist; }
      if (side === 3) { dx = -dist; dy = (Math.random() - 0.5) * dist; }

      return { dx, dy };
    }

    function buildPuzzleParagraph(p) {
      const original = p.textContent;
      const parts = splitIntoChunks(original, chunkSize);

      p.textContent = ''; // 清空
      p.classList.add('puzzle-ready');

      parts.forEach((part, i) => {
        const span = document.createElement('span');
        span.className = 'piece';
        span.textContent = part + ' '; // 保留空格

        const { dx, dy } = randomFromSides();
        const rot = (Math.random() - 0.5) * 18; // -9deg ~ 9deg
        const delay = i * 55 + Math.random() * 60; // 拼图节奏

        span.style.setProperty('--dx', dx.toFixed(0) + 'px');
        span.style.setProperty('--dy', dy.toFixed(0) + 'px');
        span.style.setProperty('--rot', rot.toFixed(1) + 'deg');
        span.style.setProperty('--delay', delay.toFixed(0) + 'ms');

        p.appendChild(span);
      });
    }

    // 1) 先把所有 puzzle 段落构造成碎片
    const puzzles = document.querySelectorAll('p.puzzle');
    puzzles.forEach(buildPuzzleParagraph);

    // 2) 滚动到时触发一次拼合
    const io = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
          io.unobserve(entry.target);
        }
      });
    }, { threshold: 0.25 });

    puzzles.forEach(p => io.observe(p));
  </script>

</body>
</html>
